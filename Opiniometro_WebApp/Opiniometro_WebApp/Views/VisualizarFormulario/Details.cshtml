@model Opiniometro_WebApp.Models.Formulario

@{
    ViewBag.Title = "Details";
}

@Html.Partial("~\\Views\\Shared\\Auth\\BarraLogin.cshtml")

@foreach (var title in Model.Formulario_Respuesta.Take(1))
{
    <td>
        <h4 style="text-align:left;">
            <b>Sigla:</b>
            @Html.DisplayFor(modelItem => title.Grupo.SiglaCurso)

            <span style="float:right;">
                <b>Profesor:</b>
                @Html.DisplayFor(modelItem => title.Profesor.Persona.Nombre)
                @Html.DisplayFor(modelItem => title.Profesor.Persona.Apellido1)
                @Html.DisplayFor(modelItem => title.Profesor.Persona.Apellido2)
            </span>

            <br><br>

            <b>Curso:</b>
            @Html.DisplayFor(modelItem => title.Grupo.Curso.Nombre)

            <span style="float:right;">
                <b>Semestre:</b> 
                @Html.DisplayFor(modelItem => title.Grupo.SemestreGrupo)

                <b>Año:</b>
                @Html.DisplayFor(modelItem => title.Grupo.AnnoGrupo)
            </span>

            <br><br>

            <b>Formulario:</b>
            @Html.DisplayFor(modelItem => title.CodigoFormulario)

            @Html.DisplayFor(modelItem => title.Formulario.Nombre)

            <span style="float:right;">
                <b>Grupo:</b>
                @Html.DisplayFor(modelItem => title.Grupo.Numero)
            </span>

        </h4>
    </td>

    <br><br>
}




@{int id_counter = 0; int seccion_counter = 0; bool? observation = true; string seccion_actual = ""; string item_actual = ""; List<string> secciones = new List<string>(); bool seccion_repetida = false;}

<div class="panel-group" id="accordion1">

    @foreach (var formulario in Model.Conformado_Item_Sec_Form)
    {
        seccion_actual = formulario.TituloSeccion;

        @*Se ocupa poner una restriccion para no mostrar seciones repetidas*@

        if (secciones.Contains(seccion_actual)) { seccion_repetida = true; }
        else { secciones.Add(seccion_actual); seccion_repetida = false; }


        if (seccion_repetida == false)
        {

            <div class="panel panel-default">
                <div class="panel-heading">
                    <h4 class="panel-title">
                        <a data-toggle="collapse" data-parent="#accordion1" href="#collapseThree_@id_counter">
                            @Html.DisplayFor(model => formulario.TituloSeccion) @*Despliega las secciones de un formulario en especifico*@
                        </a>
                    </h4>
                </div>
                <div id="collapseThree_@id_counter" class="panel-collapse collapse">
                    <div class="panel-body">

                        <div class="panel-group" id="accordion2_@id_counter">

                            @foreach (var seccion in Model.Conformado_Item_Sec_Form)
                            {
                                item_actual = seccion.Item.ItemId;

                                if (seccion.TituloSeccion == seccion_actual && seccion.ItemId == item_actual)
                                {
                                    <div class="panel panel-default">
                                        <div class="panel-heading">
                                            <h4 class="panel-title">
                                                <a data-toggle="collapse" data-parent="#accordion2_@id_counter" href="#collapseThreeOne_@seccion_counter">
                                                    @Html.DisplayFor(model => seccion.Item.TextoPregunta) @*Despliega las preguntas de una seccion en especifico*@
                                                </a>
                                            </h4>
                                        </div>
                                        <div id="collapseThreeOne_@seccion_counter" class="panel-collapse collapse">
                                            <div class="panel-body">

                                                @if (seccion.Item.TipoPregunta != 1)
                                                {
                                                    <p>Resultados</p> @*Aqui se ingresa el grafico y desde aqui se mostrarian las observaciones posteriormente, acordarse de ponder una condicion si el tipo de pregunta posee grafico o no*@
                                                }
                                                else
                                                {
                                                    <div style="height:180px; overflow-y: scroll;">

                                                        @foreach (var item in Model.Conformado_Item_Sec_Form)
                                                        {
                                                            <p>Respuesta de estudiante, texto para verificar que el tamanno para el cuadro de texto sea apropiado, lo cual indica que se pueda ver la suficiente informacion, a la vez que no se consuma mucho espacio en pantalla y evite al usuario concentrase en la respuesta de una pregunta. Tambien para comprobar con los companneros de equipo que les parece y si creen que el tamanno deber ser mas grande o mas pequenno, ya que se tiene que tomar un promedio del tamanno de una respuesta de un estudiante.</p>
                                                            <hr>

                                                            @*Se ocupa encontrar la forma de devolver las respuesta de texto_libre por pregunta*@
                                                        }
                                                    </div>
                                                }

                                                <div class="panel-group" id="accordion3_@seccion_counter">

                                                    @if (seccion.Item.TieneObservacion == observation)
                                                    {
                                                        <div class="panel panel-default">
                                                            <div class="panel-heading">
                                                                <h4 class="panel-title">
                                                                    <a data-toggle="collapse" data-parent="#accordion3_@seccion_counter" href="#collapseThreeTwo_@seccion_counter">
                                                                        Observaciones @*Aqui se muestran las observaciones relacionadas a una preguntas*@
                                                                    </a>
                                                                </h4>
                                                            </div>
                                                            <div id="collapseThreeTwo_@seccion_counter" class="panel-collapse collapse">
                                                                <div class="panel-body">
                                                                    <div style="height:200px; overflow-y: scroll;">
                                                                        @foreach (var item in Model.Conformado_Item_Sec_Form)
                                                                        {
                                                                            <p>Respuesta de estudiante, texto para verificar que el tamanno para el cuadro de texto sea apropiado, lo cual indica que se pueda ver la suficiente informacion, a la vez que no se consuma mucho espacio en pantalla y evite al usuario concentrase en la respuesta de una pregunta. Tambien para comprobar con los companneros de equipo que les parece y si creen que el tamanno deber ser mas grande o mas pequenno, ya que se tiene que tomar un promedio del tamanno de una respuesta de un estudiante.</p> 
                                                                            <hr>

                                                                            @*Se ocupa encontrar la forma de devolver las observaciones por pregunta*@
                                                                        }
                                                                    </div>

                                                                </div>
                                                            </div>
                                                        </div>
                                                    }


                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    seccion_counter++;
                                }
                            }
                        </div>

                    </div>
                </div>
            </div>

            id_counter++;
        }
    }

</div>

<script src="~/Scripts/Graficar.js"></script>
@*<script>function graficarResultados(itemId) {
    alert(itemId);
    $.get("/VisualizarFormulario/GraficoPie", { itemId });
}</script>*@ 